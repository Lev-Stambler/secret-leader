\section{Ideal MSLE Functionality}
We use a similar notion of ideal functionality for a multi-secret leader election from the ideal
functionality of single secret leader election of \cite{catalano2022adaptively}
except that we add a $\registerElect$ phase for each election.

\newcommand{\FinElect}{\mathcal{E}}
\newcommand{\nBids}{b}
\begin{figure}[ht]
	\centering
	\fbox{
		\begin{minipage}{1\textwidth}
			\textbf{The MSLE functionality} $\idealMSLE$:
			Initialize $E, R \gets \emptyset, \nBids \gets 0$. Initialize $S$ to denote the set of sets
			of active participants in each round.
			Set $\FinElect \gets \emptyset$ to denote the set of finished elections.
			Fix some $k \in \N$ to denote the number of rounds. Upon receiving,
			\begin{itemize}
				\item $\register$ from party $P_i$, set $R \gets R \cup \{(i, b)\}$, broadcast $(\texttt{register}, i)$ to all parties and set $\nBids \gets \nBids + 1$
				\item $\registerElect(\eid, w)$ from party $P_i$.
				      If $\eid \in \FinElect$ send $\bot$ to $P_i$ and do nothing.
				      If $(i, w) \notin R$ or $(i, w) \in S_\eid$, send $\bot$ to $P_i$ and do nothing.
				      If $S_\eid$ is not defined, set $S_\eid \gets \{(i, w)\}$.
				      Otherwise, set $S_\eid \gets S_\eid \cup \{(i, w)\}$.
				\item $\elect(\eid)$ Elect $k$ leaders from $S_\eid \subseteq R$ parties.
				      If $|S| \geq k$ and $\eid \notin \FinElect$,
				      randomly sample $W^{\eid} \subseteq S_\eid$ where $|W^{\eid}| = k$.
				      Then, assign a random ordering to $W^\eid$ to get ordered set $E^\eid$.
				      Next, send $(\texttt{outcome}, \eid, a)$ to $P_j$ for all $E^\eid_a = (j, \cdot)$
				      and $(\texttt{outcome}, \eid, \bot)$ to $P_i$ if $(i, \cdot) \notin E^\eid$. Store $E \gets E \bigcup \{E^\eid\}$.
				      Set $\FinElect \gets \FinElect \cup \{\eid\}$.
				\item $\reveal$ from $P_i$: for $E_\eid \in E$, if $i = E^\eid_\ell$, broadcast $(\texttt{result}, \eid, \ell, i)$.
				      Otherwise, broadcast $(\texttt{rejected}, \eid, \ell, i)$.
			\end{itemize}
		\end{minipage}
	}
	\caption{Description of the Multi Secret Leader Election functionality}.
	\label{fig:my_label}
\end{figure}

